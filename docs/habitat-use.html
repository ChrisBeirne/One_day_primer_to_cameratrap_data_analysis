<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 10 Habitat use | An Primer to Camera Trap Data Management and Analysis in R</title>
  <meta name="description" content="One day primer forcamera trap data management and analysis course" />
  <meta name="generator" content="bookdown 0.39 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 10 Habitat use | An Primer to Camera Trap Data Management and Analysis in R" />
  <meta property="og:type" content="book" />
  
  <meta property="og:description" content="One day primer forcamera trap data management and analysis course" />
  <meta name="github-repo" content="ChrisBeirne/One_day_primer_to_cameratrap_data_analysis" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 10 Habitat use | An Primer to Camera Trap Data Management and Analysis in R" />
  
  <meta name="twitter:description" content="One day primer forcamera trap data management and analysis course" />
  

<meta name="author" content="Christopher Beirne, the Wildlife Coexistence Lab, UBC, and the WildCam Network" />


<meta name="date" content="2024-05-07" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="composition.html"/>
<link rel="next" href="occupancy.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>
<script src="libs/kePrint-0.0.1/kePrint.js"></script>
<link href="libs/lightable-0.0.1/lightable.css" rel="stylesheet" />
<link href="libs/bsTable-3.3.7/bootstrapTable.min.css" rel="stylesheet" />
<script src="libs/bsTable-3.3.7/bootstrapTable.js"></script>
<link href="libs/htmltools-fill-0.5.8.1/fill.css" rel="stylesheet" />
<script src="libs/htmlwidgets-1.6.4/htmlwidgets.js"></script>
<link href="libs/leaflet-1.3.1/leaflet.css" rel="stylesheet" />
<script src="libs/leaflet-1.3.1/leaflet.js"></script>
<link href="libs/leafletfix-1.0.0/leafletfix.css" rel="stylesheet" />
<script src="libs/proj4-2.6.2/proj4.min.js"></script>
<script src="libs/Proj4Leaflet-1.0.1/proj4leaflet.js"></script>
<link href="libs/rstudio_leaflet-1.3.1/rstudio_leaflet.css" rel="stylesheet" />
<script src="libs/leaflet-binding-2.2.2/leaflet.js"></script>
<script src="libs/leaflet-providers-2.0.0/leaflet-providers_2.0.0.js"></script>
<script src="libs/leaflet-providers-plugin-2.2.2/leaflet-providers-plugin.js"></script>
<script src="libs/plotly-binding-4.10.4/plotly.js"></script>
<script src="libs/typedarray-0.1/typedarray.min.js"></script>
<link href="libs/crosstalk-1.2.1/css/crosstalk.min.css" rel="stylesheet" />
<script src="libs/crosstalk-1.2.1/js/crosstalk.min.js"></script>
<link href="libs/plotly-htmlwidgets-css-2.11.1/plotly-htmlwidgets.css" rel="stylesheet" />
<script src="libs/plotly-main-2.11.1/plotly-latest.min.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
  
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">WildCo Data Analysis Intro</a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Introduction</a>
<ul>
<li class="chapter" data-level="1.1" data-path="index.html"><a href="index.html#how-to-use-this-book"><i class="fa fa-check"></i><b>1.1</b> How to use this book</a></li>
<li class="chapter" data-level="1.2" data-path="index.html"><a href="index.html#get-in-touch"><i class="fa fa-check"></i><b>1.2</b> Get in touch</a></li>
<li class="chapter" data-level="1.3" data-path="index.html"><a href="index.html#cite-the-course"><i class="fa fa-check"></i><b>1.3</b> Cite the course</a></li>
<li class="chapter" data-level="1.4" data-path="index.html"><a href="index.html#acknowledgements"><i class="fa fa-check"></i><b>1.4</b> Acknowledgements</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="prep.html"><a href="prep.html"><i class="fa fa-check"></i><b>2</b> Preparing for the course</a>
<ul>
<li class="chapter" data-level="2.1" data-path="prep.html"><a href="prep.html#install-r"><i class="fa fa-check"></i><b>2.1</b> Install R</a></li>
<li class="chapter" data-level="2.2" data-path="prep.html"><a href="prep.html#install-rstudio"><i class="fa fa-check"></i><b>2.2</b> Install RStudio</a></li>
<li class="chapter" data-level="2.3" data-path="prep.html"><a href="prep.html#install-the-required-packages"><i class="fa fa-check"></i><b>2.3</b> Install the required packages</a>
<ul>
<li class="chapter" data-level="2.3.1" data-path="prep.html"><a href="prep.html#cran-packages"><i class="fa fa-check"></i><b>2.3.1</b> CRAN packages</a></li>
<li class="chapter" data-level="2.3.2" data-path="prep.html"><a href="prep.html#other-packages"><i class="fa fa-check"></i><b>2.3.2</b> Other packages</a></li>
</ul></li>
<li class="chapter" data-level="2.4" data-path="prep.html"><a href="prep.html#create-an-r-project"><i class="fa fa-check"></i><b>2.4</b> Create an R project</a></li>
<li class="chapter" data-level="2.5" data-path="prep.html"><a href="prep.html#download-the-data-files"><i class="fa fa-check"></i><b>2.5</b> Download the data files</a></li>
<li class="chapter" data-level="2.6" data-path="prep.html"><a href="prep.html#the-example-datasets"><i class="fa fa-check"></i><b>2.6</b> The example datasets</a>
<ul>
<li class="chapter" data-level="2.6.1" data-path="prep.html"><a href="prep.html#example_data"><i class="fa fa-check"></i><b>2.6.1</b> example_data</a></li>
<li class="chapter" data-level="2.6.2" data-path="prep.html"><a href="prep.html#your_data"><i class="fa fa-check"></i><b>2.6.2</b> your_data</a></li>
</ul></li>
<li class="chapter" data-level="2.7" data-path="prep.html"><a href="prep.html#practise-before-the-course"><i class="fa fa-check"></i><b>2.7</b> Practise before the course</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="preprocessing-and-labelling.html"><a href="preprocessing-and-labelling.html"><i class="fa fa-check"></i><b>3</b> Preprocessing and labelling</a>
<ul>
<li class="chapter" data-level="3.1" data-path="preprocessing-and-labelling.html"><a href="preprocessing-and-labelling.html#data-storage"><i class="fa fa-check"></i><b>3.1</b> Data storage</a></li>
<li class="chapter" data-level="3.2" data-path="preprocessing-and-labelling.html"><a href="preprocessing-and-labelling.html#preprocessing"><i class="fa fa-check"></i><b>3.2</b> Preprocessing</a>
<ul>
<li class="chapter" data-level="3.2.1" data-path="preprocessing-and-labelling.html"><a href="preprocessing-and-labelling.html#renaming"><i class="fa fa-check"></i><b>3.2.1</b> Renaming</a></li>
<li class="chapter" data-level="3.2.2" data-path="preprocessing-and-labelling.html"><a href="preprocessing-and-labelling.html#automated-labelers"><i class="fa fa-check"></i><b>3.2.2</b> Automated Labelers</a></li>
<li class="chapter" data-level="3.2.3" data-path="preprocessing-and-labelling.html"><a href="preprocessing-and-labelling.html#sensitive-images"><i class="fa fa-check"></i><b>3.2.3</b> Sensitive images</a></li>
<li class="chapter" data-level="3.2.4" data-path="preprocessing-and-labelling.html"><a href="preprocessing-and-labelling.html#timelapse-extraction"><i class="fa fa-check"></i><b>3.2.4</b> Timelapse extraction</a></li>
</ul></li>
<li class="chapter" data-level="3.3" data-path="preprocessing-and-labelling.html"><a href="preprocessing-and-labelling.html#labelling"><i class="fa fa-check"></i><b>3.3</b> Labelling</a></li>
<li class="chapter" data-level="3.4" data-path="preprocessing-and-labelling.html"><a href="preprocessing-and-labelling.html#end-dates-and-outages"><i class="fa fa-check"></i><b>3.4</b> End dates and outages</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="standard.html"><a href="standard.html"><i class="fa fa-check"></i><b>4</b> Metadata standardisation</a>
<ul>
<li class="chapter" data-level="4.1" data-path="standard.html"><a href="standard.html#the-wildlife-insights-minimum-metadata-standards"><i class="fa fa-check"></i><b>4.1</b> The Wildlife Insights Minimum Metadata Standards</a>
<ul>
<li class="chapter" data-level="4.1.1" data-path="standard.html"><a href="standard.html#project-data"><i class="fa fa-check"></i><b>4.1.1</b> Project data</a></li>
<li class="chapter" data-level="4.1.2" data-path="standard.html"><a href="standard.html#image-data"><i class="fa fa-check"></i><b>4.1.2</b> Image data</a></li>
<li class="chapter" data-level="4.1.3" data-path="standard.html"><a href="standard.html#deployment-data"><i class="fa fa-check"></i><b>4.1.3</b> Deployment data</a></li>
<li class="chapter" data-level="4.1.4" data-path="standard.html"><a href="standard.html#camera-inventory"><i class="fa fa-check"></i><b>4.1.4</b> Camera inventory</a></li>
<li class="chapter" data-level="4.1.5" data-path="standard.html"><a href="standard.html#important-note"><i class="fa fa-check"></i><b>4.1.5</b> Important note</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="5" data-path="error-checking.html"><a href="error-checking.html"><i class="fa fa-check"></i><b>5</b> Error checking</a>
<ul>
<li class="chapter" data-level="5.1" data-path="error-checking.html"><a href="error-checking.html#standardised-exploration-script"><i class="fa fa-check"></i><b>5.1</b> Standardised exploration script</a></li>
<li class="chapter" data-level="5.2" data-path="error-checking.html"><a href="error-checking.html#formatting-dates"><i class="fa fa-check"></i><b>5.2</b> Formatting dates</a>
<ul>
<li class="chapter" data-level="5.2.1" data-path="error-checking.html"><a href="error-checking.html#deployment-dates"><i class="fa fa-check"></i><b>5.2.1</b> Deployment dates</a></li>
<li class="chapter" data-level="5.2.2" data-path="error-checking.html"><a href="error-checking.html#image-dates"><i class="fa fa-check"></i><b>5.2.2</b> Image dates</a></li>
</ul></li>
<li class="chapter" data-level="5.3" data-path="error-checking.html"><a href="error-checking.html#basic-trapping-summaries"><i class="fa fa-check"></i><b>5.3</b> Basic trapping summaries</a></li>
<li class="chapter" data-level="5.4" data-path="error-checking.html"><a href="error-checking.html#error-checks"><i class="fa fa-check"></i><b>5.4</b> Error checks</a>
<ul>
<li class="chapter" data-level="5.4.1" data-path="error-checking.html"><a href="error-checking.html#camera-locations"><i class="fa fa-check"></i><b>5.4.1</b> Camera locations</a></li>
<li class="chapter" data-level="5.4.2" data-path="error-checking.html"><a href="error-checking.html#camera-activity-checks"><i class="fa fa-check"></i><b>5.4.2</b> Camera activity checks</a></li>
<li class="chapter" data-level="5.4.3" data-path="error-checking.html"><a href="error-checking.html#detection-check"><i class="fa fa-check"></i><b>5.4.3</b> Detection check</a></li>
<li class="chapter" data-level="5.4.4" data-path="error-checking.html"><a href="error-checking.html#taxonomy-check"><i class="fa fa-check"></i><b>5.4.4</b> Taxonomy check</a></li>
</ul></li>
<li class="chapter" data-level="5.5" data-path="error-checking.html"><a href="error-checking.html#diel-activity-check"><i class="fa fa-check"></i><b>5.5</b> Diel activity check</a></li>
<li class="chapter" data-level="5.6" data-path="error-checking.html"><a href="error-checking.html#conclusion"><i class="fa fa-check"></i><b>5.6</b> Conclusion</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="data-creation.html"><a href="data-creation.html"><i class="fa fa-check"></i><b>6</b> Analysis data creation</a>
<ul>
<li class="chapter" data-level="6.1" data-path="data-creation.html"><a href="data-creation.html#common-analysis-data-formats"><i class="fa fa-check"></i><b>6.1</b> Common analysis data formats</a></li>
<li class="chapter" data-level="6.2" data-path="data-creation.html"><a href="data-creation.html#independent-detections"><i class="fa fa-check"></i><b>6.2</b> Independent detections</a></li>
<li class="chapter" data-level="6.3" data-path="data-creation.html"><a href="data-creation.html#effort-look-up"><i class="fa fa-check"></i><b>6.3</b> Effort look-up</a></li>
<li class="chapter" data-level="6.4" data-path="data-creation.html"><a href="data-creation.html#observations-by-time-interval"><i class="fa fa-check"></i><b>6.4</b> Observations by time interval</a></li>
<li class="chapter" data-level="6.5" data-path="data-creation.html"><a href="data-creation.html#our-data"><i class="fa fa-check"></i><b>6.5</b> Our data</a>
<ul>
<li class="chapter" data-level="6.5.1" data-path="data-creation.html"><a href="data-creation.html#filter-to-target-species"><i class="fa fa-check"></i><b>6.5.1</b> Filter to target species</a></li>
<li class="chapter" data-level="6.5.2" data-path="data-creation.html"><a href="data-creation.html#create-a-daily-camera-activity-lookup"><i class="fa fa-check"></i><b>6.5.2</b> Create a daily camera activity lookup</a></li>
<li class="chapter" data-level="6.5.3" data-path="data-creation.html"><a href="data-creation.html#determine-independent-camera-detections"><i class="fa fa-check"></i><b>6.5.3</b> Determine ‘independent’ camera detections</a></li>
<li class="chapter" data-level="6.5.4" data-path="data-creation.html"><a href="data-creation.html#add-additional-data"><i class="fa fa-check"></i><b>6.5.4</b> Add additional data</a></li>
</ul></li>
<li class="chapter" data-level="6.6" data-path="data-creation.html"><a href="data-creation.html#creating-analysis-dataframes"><i class="fa fa-check"></i><b>6.6</b> Creating analysis dataframes</a>
<ul>
<li class="chapter" data-level="6.6.1" data-path="data-creation.html"><a href="data-creation.html#final-data-check"><i class="fa fa-check"></i><b>6.6.1</b> Final data check</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="7" data-path="covariates.html"><a href="covariates.html"><i class="fa fa-check"></i><b>7</b> Analysis covariates</a>
<ul>
<li class="chapter" data-level="7.1" data-path="covariates.html"><a href="covariates.html#camera-station-covariates"><i class="fa fa-check"></i><b>7.1</b> Camera station covariates</a>
<ul>
<li class="chapter" data-level="7.1.1" data-path="covariates.html"><a href="covariates.html#locally-collected-covariates"><i class="fa fa-check"></i><b>7.1.1</b> Locally collected covariates</a></li>
<li class="chapter" data-level="7.1.2" data-path="covariates.html"><a href="covariates.html#remotely-collected-covariates"><i class="fa fa-check"></i><b>7.1.2</b> Remotely collected covariates</a></li>
<li class="chapter" data-level="7.1.3" data-path="covariates.html"><a href="covariates.html#extracting-data-from-local-rasters"><i class="fa fa-check"></i><b>7.1.3</b> Extracting data from local rasters</a></li>
<li class="chapter" data-level="7.1.4" data-path="covariates.html"><a href="covariates.html#elevatr-package"><i class="fa fa-check"></i><b>7.1.4</b> elevatr package</a></li>
<li class="chapter" data-level="7.1.5" data-path="covariates.html"><a href="covariates.html#open-street-maps"><i class="fa fa-check"></i><b>7.1.5</b> Open Street Maps</a></li>
<li class="chapter" data-level="7.1.6" data-path="covariates.html"><a href="covariates.html#vegetation-productivity"><i class="fa fa-check"></i><b>7.1.6</b> Vegetation productivity</a></li>
</ul></li>
<li class="chapter" data-level="7.2" data-path="covariates.html"><a href="covariates.html#convert-and-save-your-covariates"><i class="fa fa-check"></i><b>7.2</b> Convert and save your covariates</a></li>
<li class="chapter" data-level="7.3" data-path="covariates.html"><a href="covariates.html#correlations-between-predictors"><i class="fa fa-check"></i><b>7.3</b> Correlations between predictors</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="exploration.html"><a href="exploration.html"><i class="fa fa-check"></i><b>8</b> Analysis data exploration</a>
<ul>
<li class="chapter" data-level="8.1" data-path="exploration.html"><a href="exploration.html#final-locations-plot"><i class="fa fa-check"></i><b>8.1</b> Final locations plot</a></li>
<li class="chapter" data-level="8.2" data-path="exploration.html"><a href="exploration.html#independent-detections-summary"><i class="fa fa-check"></i><b>8.2</b> Independent detections summary</a>
<ul>
<li class="chapter" data-level="8.2.1" data-path="exploration.html"><a href="exploration.html#raw-occupancy"><i class="fa fa-check"></i><b>8.2.1</b> Raw occupancy</a></li>
<li class="chapter" data-level="8.2.2" data-path="exploration.html"><a href="exploration.html#comparison-plot"><i class="fa fa-check"></i><b>8.2.2</b> Comparison plot</a></li>
</ul></li>
<li class="chapter" data-level="8.3" data-path="exploration.html"><a href="exploration.html#temporal-patterns-in-capture-rates"><i class="fa fa-check"></i><b>8.3</b> Temporal patterns in capture rates</a></li>
<li class="chapter" data-level="8.4" data-path="exploration.html"><a href="exploration.html#species-specific-capture-rates"><i class="fa fa-check"></i><b>8.4</b> Species-specific capture rates</a></li>
<li class="chapter" data-level="8.5" data-path="exploration.html"><a href="exploration.html#spatial-patterns-in-capture-rates"><i class="fa fa-check"></i><b>8.5</b> Spatial patterns in capture rates</a></li>
<li class="chapter" data-level="8.6" data-path="exploration.html"><a href="exploration.html#species-co-occurences"><i class="fa fa-check"></i><b>8.6</b> Species co-occurences</a></li>
<li class="chapter" data-level="8.7" data-path="exploration.html"><a href="exploration.html#covariate-plots"><i class="fa fa-check"></i><b>8.7</b> Covariate plots</a>
<ul>
<li class="chapter" data-level="8.7.1" data-path="exploration.html"><a href="exploration.html#continuous-predictors"><i class="fa fa-check"></i><b>8.7.1</b> Continuous predictors</a></li>
<li class="chapter" data-level="8.7.2" data-path="exploration.html"><a href="exploration.html#catagorical-predictors"><i class="fa fa-check"></i><b>8.7.2</b> Catagorical predictors</a></li>
<li class="chapter" data-level="8.7.3" data-path="exploration.html"><a href="exploration.html#do-your-own-exploration"><i class="fa fa-check"></i><b>8.7.3</b> Do your own exploration</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="9" data-path="composition.html"><a href="composition.html"><i class="fa fa-check"></i><b>9</b> Community composition</a>
<ul>
<li class="chapter" data-level="9.1" data-path="composition.html"><a href="composition.html#observed-richness"><i class="fa fa-check"></i><b>9.1</b> Observed richness</a></li>
<li class="chapter" data-level="9.2" data-path="composition.html"><a href="composition.html#estimated-richness"><i class="fa fa-check"></i><b>9.2</b> Estimated richness</a>
<ul>
<li class="chapter" data-level="9.2.1" data-path="composition.html"><a href="composition.html#inext-package"><i class="fa fa-check"></i><b>9.2.1</b> iNext package</a></li>
<li class="chapter" data-level="9.2.2" data-path="composition.html"><a href="composition.html#sampling-duration-example"><i class="fa fa-check"></i><b>9.2.2</b> Sampling duration example</a></li>
</ul></li>
<li class="chapter" data-level="9.3" data-path="composition.html"><a href="composition.html#other-diversity-metrics"><i class="fa fa-check"></i><b>9.3</b> Other diversity metrics</a>
<ul>
<li class="chapter" data-level="9.3.1" data-path="composition.html"><a href="composition.html#simpson-and-shannon"><i class="fa fa-check"></i><b>9.3.1</b> Simpson and Shannon</a></li>
<li class="chapter" data-level="9.3.2" data-path="composition.html"><a href="composition.html#more-examples-in-the-literature"><i class="fa fa-check"></i><b>9.3.2</b> More examples in the literature</a></li>
<li class="chapter" data-level="9.3.3" data-path="composition.html"><a href="composition.html#multispecies-occupancy-model"><i class="fa fa-check"></i><b>9.3.3</b> Multispecies occupancy model</a></li>
</ul></li>
<li class="chapter" data-level="9.4" data-path="composition.html"><a href="composition.html#community-structure"><i class="fa fa-check"></i><b>9.4</b> Community structure</a>
<ul>
<li class="chapter" data-level="9.4.1" data-path="composition.html"><a href="composition.html#extracting-data-for-plotting"><i class="fa fa-check"></i><b>9.4.1</b> Extracting data for plotting</a></li>
<li class="chapter" data-level="9.4.2" data-path="composition.html"><a href="composition.html#examples-in-the-literature"><i class="fa fa-check"></i><b>9.4.2</b> Examples in the literature</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="10" data-path="habitat-use.html"><a href="habitat-use.html"><i class="fa fa-check"></i><b>10</b> Habitat use</a>
<ul>
<li class="chapter" data-level="10.1" data-path="habitat-use.html"><a href="habitat-use.html#calculating-capture-rate"><i class="fa fa-check"></i><b>10.1</b> Calculating capture rate</a>
<ul>
<li class="chapter" data-level="10.1.1" data-path="habitat-use.html"><a href="habitat-use.html#examples-from-the-literature"><i class="fa fa-check"></i><b>10.1.1</b> Examples from the literature</a></li>
</ul></li>
<li class="chapter" data-level="10.2" data-path="habitat-use.html"><a href="habitat-use.html#single-species-models"><i class="fa fa-check"></i><b>10.2</b> Single-species models</a>
<ul>
<li class="chapter" data-level="10.2.1" data-path="habitat-use.html"><a href="habitat-use.html#simple-linear-model"><i class="fa fa-check"></i><b>10.2.1</b> Simple linear model</a></li>
<li class="chapter" data-level="10.2.2" data-path="habitat-use.html"><a href="habitat-use.html#catagorical-predictor"><i class="fa fa-check"></i><b>10.2.2</b> Catagorical predictor</a></li>
<li class="chapter" data-level="10.2.3" data-path="habitat-use.html"><a href="habitat-use.html#continuous-predictor"><i class="fa fa-check"></i><b>10.2.3</b> Continuous predictor</a></li>
<li class="chapter" data-level="10.2.4" data-path="habitat-use.html"><a href="habitat-use.html#model-comparisons"><i class="fa fa-check"></i><b>10.2.4</b> Model comparisons</a></li>
<li class="chapter" data-level="10.2.5" data-path="habitat-use.html"><a href="habitat-use.html#problems-with-these-models"><i class="fa fa-check"></i><b>10.2.5</b> Problems with these models</a></li>
<li class="chapter" data-level="10.2.6" data-path="habitat-use.html"><a href="habitat-use.html#mixed-effects-models"><i class="fa fa-check"></i><b>10.2.6</b> Mixed-effects models</a></li>
<li class="chapter" data-level="10.2.7" data-path="habitat-use.html"><a href="habitat-use.html#advanced-mixed-model-predictions"><i class="fa fa-check"></i><b>10.2.7</b> Advanced mixed-model predictions</a></li>
<li class="chapter" data-level="10.2.8" data-path="habitat-use.html"><a href="habitat-use.html#examples-in-the-literature-1"><i class="fa fa-check"></i><b>10.2.8</b> Examples in the literature</a></li>
</ul></li>
<li class="chapter" data-level="10.3" data-path="habitat-use.html"><a href="habitat-use.html#multispecies-models"><i class="fa fa-check"></i><b>10.3</b> Multispecies models</a>
<ul>
<li class="chapter" data-level="10.3.1" data-path="habitat-use.html"><a href="habitat-use.html#potential-dangers"><i class="fa fa-check"></i><b>10.3.1</b> Potential dangers</a></li>
<li class="chapter" data-level="10.3.2" data-path="habitat-use.html"><a href="habitat-use.html#further-reading"><i class="fa fa-check"></i><b>10.3.2</b> Further reading</a></li>
<li class="chapter" data-level="10.3.3" data-path="habitat-use.html"><a href="habitat-use.html#examples-in-the-literature-2"><i class="fa fa-check"></i><b>10.3.3</b> Examples in the literature</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="11" data-path="occupancy.html"><a href="occupancy.html"><i class="fa fa-check"></i><b>11</b> Occupancy</a>
<ul>
<li class="chapter" data-level="11.1" data-path="occupancy.html"><a href="occupancy.html#single-species-occupancy-model"><i class="fa fa-check"></i><b>11.1</b> Single species occupancy model</a>
<ul>
<li class="chapter" data-level="11.1.1" data-path="occupancy.html"><a href="occupancy.html#unmarked-package"><i class="fa fa-check"></i><b>11.1.1</b> Unmarked package</a></li>
<li class="chapter" data-level="11.1.2" data-path="occupancy.html"><a href="occupancy.html#plotting-predictions"><i class="fa fa-check"></i><b>11.1.2</b> Plotting predictions</a></li>
<li class="chapter" data-level="11.1.3" data-path="occupancy.html"><a href="occupancy.html#on-your-own"><i class="fa fa-check"></i><b>11.1.3</b> On your own</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="12" data-path="activity.html"><a href="activity.html"><i class="fa fa-check"></i><b>12</b> Activity</a>
<ul>
<li class="chapter" data-level="12.1" data-path="activity.html"><a href="activity.html#independent-detections-or-raw-data"><i class="fa fa-check"></i><b>12.1</b> Independent detections or raw data?</a></li>
<li class="chapter" data-level="12.2" data-path="activity.html"><a href="activity.html#data-formatting"><i class="fa fa-check"></i><b>12.2</b> Data formatting</a>
<ul>
<li class="chapter" data-level="12.2.1" data-path="activity.html"><a href="activity.html#accounting-for-sunrise-and-sunset"><i class="fa fa-check"></i><b>12.2.1</b> Accounting for sunrise and sunset</a></li>
</ul></li>
<li class="chapter" data-level="12.3" data-path="activity.html"><a href="activity.html#species-comparisons"><i class="fa fa-check"></i><b>12.3</b> Species comparisons</a></li>
<li class="chapter" data-level="12.4" data-path="activity.html"><a href="activity.html#treatment-comparisons"><i class="fa fa-check"></i><b>12.4</b> Treatment comparisons</a>
<ul>
<li class="chapter" data-level="12.4.1" data-path="activity.html"><a href="activity.html#seasonal-comparison"><i class="fa fa-check"></i><b>12.4.1</b> Seasonal comparison</a></li>
</ul></li>
<li class="chapter" data-level="12.5" data-path="activity.html"><a href="activity.html#selected-further-reading"><i class="fa fa-check"></i><b>12.5</b> Selected further reading</a></li>
</ul></li>
<li class="chapter" data-level="13" data-path="density.html"><a href="density.html"><i class="fa fa-check"></i><b>13</b> Density</a>
<ul>
<li class="chapter" data-level="13.1" data-path="density.html"><a href="density.html#individually-identifiable-individuals"><i class="fa fa-check"></i><b>13.1</b> Individually identifiable individuals</a></li>
<li class="chapter" data-level="13.2" data-path="density.html"><a href="density.html#unmarked-animals"><i class="fa fa-check"></i><b>13.2</b> Unmarked animals</a>
<ul>
<li class="chapter" data-level="13.2.1" data-path="density.html"><a href="density.html#random-encounter-model"><i class="fa fa-check"></i><b>13.2.1</b> Random encounter model</a></li>
<li class="chapter" data-level="13.2.2" data-path="density.html"><a href="density.html#moose"><i class="fa fa-check"></i><b>13.2.2</b> Moose</a></li>
<li class="chapter" data-level="13.2.3" data-path="density.html"><a href="density.html#wolf"><i class="fa fa-check"></i><b>13.2.3</b> Wolf</a></li>
</ul></li>
<li class="chapter" data-level="13.3" data-path="density.html"><a href="density.html#future-directions"><i class="fa fa-check"></i><b>13.3</b> Future directions</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i>References</a></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">An Primer to Camera Trap Data Management and Analysis in R</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="habitat-use" class="section level1 hasAnchor" number="10">
<h1><span class="header-section-number">Chapter 10</span> Habitat use<a href="habitat-use.html#habitat-use" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<p>Camera traps are well suited for the quantification of habitat use across multiple species. To assess habitat use, we typically quantify the detection rate - the number of detections divided by the time interval of interest. As detection rates are fairly simple to estimate and conceptually simple to understand, thus their use is widespread in the camera trap literature.</p>
<p>In its simplest form habitat use represents the number of independent events of a given species at a given camera, divided by the number of days that camera was active during that period of interest.</p>
<p>This ‘detection rate’ is thought to reflect the habitat use of a species at a given location. Extreme care should be taken if you want to equate use with abundance or density - something we discuss a little more in the <a href="density.html#density">density chapter</a>.</p>
<p>Detection rates are typically analysed in a linear modelling framework, and come in single species and multi-species versions (see below).<br />
<em>Create a new .R script</em></p>
<p>Call it <code>05_example_habitat_use.R</code>.</p>
<p><em>Load the required packages</em></p>
<div class="sourceCode" id="cb127"><pre class="sourceCode r Rmain"><code class="sourceCode r"><span id="cb127-1"><a href="habitat-use.html#cb127-1" tabindex="-1"></a><span class="co"># Check you have them and load them</span></span>
<span id="cb127-2"><a href="habitat-use.html#cb127-2" tabindex="-1"></a>list.of.packages <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;kableExtra&quot;</span>, <span class="st">&quot;tidyr&quot;</span>, <span class="st">&quot;ggplot2&quot;</span>, <span class="st">&quot;gridExtra&quot;</span>, <span class="st">&quot;lme4&quot;</span>, <span class="st">&quot;dplyr&quot;</span>, <span class="st">&quot;Hmsc&quot;</span>, <span class="st">&quot;jtools&quot;</span>, <span class="st">&quot;lubridate&quot;</span>, <span class="st">&quot;corrplot&quot;</span>, <span class="st">&quot;MuMIn&quot;</span>)</span>
<span id="cb127-3"><a href="habitat-use.html#cb127-3" tabindex="-1"></a></span>
<span id="cb127-4"><a href="habitat-use.html#cb127-4" tabindex="-1"></a>new.packages <span class="ot">&lt;-</span> list.of.packages[<span class="sc">!</span>(list.of.packages <span class="sc">%in%</span> <span class="fu">installed.packages</span>()[,<span class="st">&quot;Package&quot;</span>])]</span>
<span id="cb127-5"><a href="habitat-use.html#cb127-5" tabindex="-1"></a><span class="cf">if</span>(<span class="fu">length</span>(new.packages)) <span class="fu">install.packages</span>(new.packages)</span>
<span id="cb127-6"><a href="habitat-use.html#cb127-6" tabindex="-1"></a><span class="fu">lapply</span>(list.of.packages, require, <span class="at">character.only =</span> <span class="cn">TRUE</span>)</span></code></pre></div>
<div id="calculating-capture-rate" class="section level2 hasAnchor" number="10.1">
<h2><span class="header-section-number">10.1</span> Calculating capture rate<a href="habitat-use.html#calculating-capture-rate" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>We will start by using the <code>total_obs</code> dataframe we have used in previous chapters:</p>
<div class="sourceCode" id="cb128"><pre class="sourceCode r Rmain"><code class="sourceCode r"><span id="cb128-1"><a href="habitat-use.html#cb128-1" tabindex="-1"></a><span class="co"># Import the total observations dataset</span></span>
<span id="cb128-2"><a href="habitat-use.html#cb128-2" tabindex="-1"></a>total_obs <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">&quot;data/processed_data/AlgarRestorationProject_30min_independent_total_observations.csv&quot;</span>, <span class="at">header=</span>T)</span>
<span id="cb128-3"><a href="habitat-use.html#cb128-3" tabindex="-1"></a></span>
<span id="cb128-4"><a href="habitat-use.html#cb128-4" tabindex="-1"></a><span class="co"># Import your species list</span></span>
<span id="cb128-5"><a href="habitat-use.html#cb128-5" tabindex="-1"></a>sp_summary <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">&quot;data/processed_data/AlgarRestorationProject_species_list.csv&quot;</span>, <span class="at">header=</span>T)</span>
<span id="cb128-6"><a href="habitat-use.html#cb128-6" tabindex="-1"></a></span>
<span id="cb128-7"><a href="habitat-use.html#cb128-7" tabindex="-1"></a><span class="co"># Create a dataframe to store these detection rates</span></span>
<span id="cb128-8"><a href="habitat-use.html#cb128-8" tabindex="-1"></a>total_cr <span class="ot">&lt;-</span> total_obs</span>
<span id="cb128-9"><a href="habitat-use.html#cb128-9" tabindex="-1"></a><span class="co"># Divide the species abundances (which start in column four), by the amount of camera effort</span></span>
<span id="cb128-10"><a href="habitat-use.html#cb128-10" tabindex="-1"></a>total_cr[ ,sp_summary<span class="sc">$</span>sp ] <span class="ot">&lt;-</span> (total_cr[ , sp_summary<span class="sc">$</span>sp]<span class="sc">/</span>total_cr<span class="sc">$</span>days)<span class="sc">*</span><span class="dv">100</span></span>
<span id="cb128-11"><a href="habitat-use.html#cb128-11" tabindex="-1"></a></span>
<span id="cb128-12"><a href="habitat-use.html#cb128-12" tabindex="-1"></a><span class="co"># Make a plot of observations vs. capture rate</span></span>
<span id="cb128-13"><a href="habitat-use.html#cb128-13" tabindex="-1"></a><span class="fu">plot</span>(total_cr<span class="sc">$</span>Odocoileus.virginianus <span class="sc">~</span> total_obs<span class="sc">$</span>Odocoileus.virginianus,</span>
<span id="cb128-14"><a href="habitat-use.html#cb128-14" tabindex="-1"></a>     <span class="at">las=</span><span class="dv">1</span>, <span class="at">pch=</span><span class="dv">19</span>, </span>
<span id="cb128-15"><a href="habitat-use.html#cb128-15" tabindex="-1"></a>     <span class="at">ylab=</span><span class="st">&quot;Capture rate per 100 days&quot;</span>, </span>
<span id="cb128-16"><a href="habitat-use.html#cb128-16" tabindex="-1"></a>     <span class="at">xlab=</span><span class="st">&quot;Number of independent records&quot;</span>)</span></code></pre></div>
<p><img src="Intro-to-data-analysis_files/figure-html/ch7_2-1.png" width="672" /></p>
<p>As you can see there is not a perfect match as the capture rate accounts for the variation in effort between different sites.</p>
<div id="examples-from-the-literature" class="section level3 hasAnchor" number="10.1.1">
<h3><span class="header-section-number">10.1.1</span> Examples from the literature<a href="habitat-use.html#examples-from-the-literature" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p><a href="https://onlinelibrary.wiley.com/doi/abs/10.1111/aje.12566">Palmer, Meredith S., et al. “Evaluating relative abundance indices for terrestrial herbivores from large‐scale camera trap surveys.” African journal of ecology 56.4 (2018): 791-803.</a></p>
</div>
</div>
<div id="single-species-models" class="section level2 hasAnchor" number="10.2">
<h2><span class="header-section-number">10.2</span> Single-species models<a href="habitat-use.html#single-species-models" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>The most common way to analyse habitat-use data is through linear models. Linear models typically relate a continuous response variable - in our case capture rate - to a set of one or more discrete or continuous predictor variables. In this simple example we will explore the relationship between the capture rate of a species with the categorical ‘feature_type’ variable and the continuous <code>line_of_sight_m</code> variables.</p>
<p>There are a variety if different frameworks to fit and compare different linear models to address a host of different hypotheses, but if you are just starting out you should investigate two widely used packages:</p>
<ul>
<li><code>lme4</code> -&gt; frequentest and information theoretic approaches</li>
<li><code>brms</code> -&gt; Bayesian approaches</li>
</ul>
<p>There is no right or wrong about which package and which approach you use to test your hypotheses. Some packages have functionalities that others don’t, which may force your hand. Just make sure you understand the implications of your choices when it comes to reporting your results!</p>
<div id="simple-linear-model" class="section level3 hasAnchor" number="10.2.1">
<h3><span class="header-section-number">10.2.1</span> Simple linear model<a href="habitat-use.html#simple-linear-model" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>We will start by analyzing a frequentest linear model with a single observation for each camera location.</p>
<p>In this worked example we will analyse how habitat use varies using a linear model <code>lm()</code>. The model takes the form:</p>
<p>Response term (y) ~ fixed effect 1 (x1) + fixed effect 2 (x2), data frame (data=)</p>
<p>It is beyond the scope of this course to test the model assumptions or interrogate the findings, there are better resources to allow you to do that (e.g. we highly recommend reading <a href="https://link.springer.com/book/10.1007/978-1-4614-3900-4">Gałecki, Andrzej, and Tomasz Burzykowski. “Linear mixed-effects model.” Linear mixed-effects models using R. Springer, New York, NY, 2013. 245-273</a>).</p>
<p>In this example we will explore if the habitat use of <em>Odocoileus virginianus</em> varies based on the `feature_type’ the line of sight where it is found.</p>
<p><strong>Preparing our data</strong></p>
<p>Recall that the information about each location is recorded in the file:</p>
<div class="sourceCode" id="cb129"><pre class="sourceCode r Rmain"><code class="sourceCode r"><span id="cb129-1"><a href="habitat-use.html#cb129-1" tabindex="-1"></a><span class="co"># Import locations</span></span>
<span id="cb129-2"><a href="habitat-use.html#cb129-2" tabindex="-1"></a>locs <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">&quot;data/processed_data/AlgarRestorationProject_camera_locations_and_covariates.csv&quot;</span>, <span class="at">header=</span>T)</span>
<span id="cb129-3"><a href="habitat-use.html#cb129-3" tabindex="-1"></a></span>
<span id="cb129-4"><a href="habitat-use.html#cb129-4" tabindex="-1"></a><span class="co"># Convert to categorical factors</span></span>
<span id="cb129-5"><a href="habitat-use.html#cb129-5" tabindex="-1"></a>locs <span class="ot">&lt;-</span> locs <span class="sc">%&gt;%</span> </span>
<span id="cb129-6"><a href="habitat-use.html#cb129-6" tabindex="-1"></a>            <span class="fu">mutate_if</span>(is.character,as.factor)</span>
<span id="cb129-7"><a href="habitat-use.html#cb129-7" tabindex="-1"></a></span>
<span id="cb129-8"><a href="habitat-use.html#cb129-8" tabindex="-1"></a><span class="co"># Standardize</span></span>
<span id="cb129-9"><a href="habitat-use.html#cb129-9" tabindex="-1"></a><span class="co"># You should also standardize your covariates - it helps models coverage an facillitates comparison of effects sizes</span></span>
<span id="cb129-10"><a href="habitat-use.html#cb129-10" tabindex="-1"></a></span>
<span id="cb129-11"><a href="habitat-use.html#cb129-11" tabindex="-1"></a><span class="fu">library</span>(MuMIn)</span>
<span id="cb129-12"><a href="habitat-use.html#cb129-12" tabindex="-1"></a>z_locs <span class="ot">&lt;-</span> <span class="fu">stdize</span>(locs)</span>
<span id="cb129-13"><a href="habitat-use.html#cb129-13" tabindex="-1"></a></span>
<span id="cb129-14"><a href="habitat-use.html#cb129-14" tabindex="-1"></a><span class="co"># Add the covariate data to the capture rate datframe</span></span>
<span id="cb129-15"><a href="habitat-use.html#cb129-15" tabindex="-1"></a></span>
<span id="cb129-16"><a href="habitat-use.html#cb129-16" tabindex="-1"></a>mod_dat <span class="ot">&lt;-</span> <span class="fu">left_join</span>(total_cr, z_locs) <span class="co"># from the dplyr package</span></span></code></pre></div>
<pre><code>## Joining with `by = join_by(placename)`</code></pre>
</div>
<div id="catagorical-predictor" class="section level3 hasAnchor" number="10.2.2">
<h3><span class="header-section-number">10.2.2</span> Catagorical predictor<a href="habitat-use.html#catagorical-predictor" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>So we start by exploring the influence of ‘feature_type’ on our response term.</p>
<p><code>feature_type</code> is a a categorical variable which reflects strata where the camera trap was deployed:</p>
<ul>
<li>HumanUse = a camera on a seismic line used and maintained in an “open” state by humans</li>
<li>Offline = a camera in contiguous forest &gt;200m from a seismic line<br />
</li>
<li>NatRegen = a seismic line which is naturally regenerating</li>
</ul>
<p>Lets do a quick raw data plot to see what results we might expect:</p>
<div class="sourceCode" id="cb131"><pre class="sourceCode r Rinfo"><code class="sourceCode r"><span id="cb131-1"><a href="habitat-use.html#cb131-1" tabindex="-1"></a><span class="fu">boxplot</span>(mod_dat<span class="sc">$</span>Odocoileus.virginianus<span class="sc">~</span>mod_dat<span class="sc">$</span>feature_type,</span>
<span id="cb131-2"><a href="habitat-use.html#cb131-2" tabindex="-1"></a>        <span class="at">las=</span><span class="dv">1</span>,</span>
<span id="cb131-3"><a href="habitat-use.html#cb131-3" tabindex="-1"></a>        <span class="at">xlab=</span><span class="st">&quot;feature_type&quot;</span>,</span>
<span id="cb131-4"><a href="habitat-use.html#cb131-4" tabindex="-1"></a>        <span class="at">ylab=</span><span class="st">&quot;Habitat use&quot;</span>)</span></code></pre></div>
<p><img src="Intro-to-data-analysis_files/figure-html/ch7_9-1.png" width="672" /></p>
<p>It looks like white-tailed deer habitat use may be higher in naturally regenerating areas, but there is a lot of overlap between sites.</p>
<p>Next we will fit a simple linear model using the `lm()’ function in base R.</p>
<div class="sourceCode" id="cb132"><pre class="sourceCode r Rmain"><code class="sourceCode r"><span id="cb132-1"><a href="habitat-use.html#cb132-1" tabindex="-1"></a><span class="co"># model results &lt;- lm( Y data ~ x Data, data= dataframe source)</span></span>
<span id="cb132-2"><a href="habitat-use.html#cb132-2" tabindex="-1"></a>lm_cat <span class="ot">&lt;-</span> <span class="fu">lm</span>(Odocoileus.virginianus <span class="sc">~</span> feature_type, <span class="at">data =</span> mod_dat)</span>
<span id="cb132-3"><a href="habitat-use.html#cb132-3" tabindex="-1"></a></span>
<span id="cb132-4"><a href="habitat-use.html#cb132-4" tabindex="-1"></a><span class="co"># And check the output</span></span>
<span id="cb132-5"><a href="habitat-use.html#cb132-5" tabindex="-1"></a><span class="fu">summary</span>(lm_cat)</span></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = Odocoileus.virginianus ~ feature_type, data = mod_dat)
## 
## Residuals:
##     Min      1Q  Median      3Q     Max 
## -3.8377 -2.5572 -0.9958  1.4862  7.4681 
## 
## Coefficients:
##                      Estimate Std. Error t value Pr(&gt;|t|)  
## (Intercept)            1.1645     0.8838   1.318   0.1962  
## feature_typeNatRegen   2.6732     1.3324   2.006   0.0526 .
## feature_typeOffline    2.1782     1.2737   1.710   0.0961 .
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 3.307 on 35 degrees of freedom
## Multiple R-squared:  0.1208, Adjusted R-squared:  0.07061 
## F-statistic: 2.405 on 2 and 35 DF,  p-value: 0.105</code></pre>
<p>Categorical covariates are show as contrasts from the reference level (in this case HumanUse), and the p-value relate to testing whether the other categories are significantly different from the reference level. Other things to note are that our R-squared value (how much variation the model explains) is fairly low - but that is common in camera trap models.</p>
<p>We can take a quick look at the predictions using the <code>jtools</code> package. More examples of its use are can be found in the `<a href="https://jtools.jacob-long.com/articles/effect_plot.html">Visualizing regression model predictions vignette</a> associated with the package.</p>
<div class="sourceCode" id="cb134"><pre class="sourceCode r Rmain"><code class="sourceCode r"><span id="cb134-1"><a href="habitat-use.html#cb134-1" tabindex="-1"></a><span class="fu">effect_plot</span>(lm_cat,                  <span class="co"># The model object</span></span>
<span id="cb134-2"><a href="habitat-use.html#cb134-2" tabindex="-1"></a>            <span class="at">pred =</span> feature_type,     <span class="co"># The variable you want to predict</span></span>
<span id="cb134-3"><a href="habitat-use.html#cb134-3" tabindex="-1"></a>            <span class="at">interval =</span> <span class="cn">TRUE</span>,         <span class="co"># Whether you want confidence intervals (default = 0.95)</span></span>
<span id="cb134-4"><a href="habitat-use.html#cb134-4" tabindex="-1"></a>            <span class="at">partial.residuals =</span> T,   <span class="co"># Show the residual variation -after accounting for fixed effects  </span></span>
<span id="cb134-5"><a href="habitat-use.html#cb134-5" tabindex="-1"></a>            <span class="at">y.label =</span> <span class="st">&quot;Habitat use&quot;</span>) <span class="co"># Change the y axis label</span></span></code></pre></div>
<p><img src="Intro-to-data-analysis_files/figure-html/ch7_12-1.png" width="672" /></p>
</div>
<div id="continuous-predictor" class="section level3 hasAnchor" number="10.2.3">
<h3><span class="header-section-number">10.2.3</span> Continuous predictor<a href="habitat-use.html#continuous-predictor" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Let’s also explore a continuous predictor <code>line_of_sight_m': We will fit a simple linear model using the</code>lm()’ function in base R.</p>
<div class="sourceCode" id="cb135"><pre class="sourceCode r Rmain"><code class="sourceCode r"><span id="cb135-1"><a href="habitat-use.html#cb135-1" tabindex="-1"></a><span class="co"># model results &lt;- lm( Y data ~ x Data, data= dataframe source)</span></span>
<span id="cb135-2"><a href="habitat-use.html#cb135-2" tabindex="-1"></a>lm_con <span class="ot">&lt;-</span> <span class="fu">lm</span>(Odocoileus.virginianus <span class="sc">~</span> z.line_of_sight_m, <span class="at">data =</span> mod_dat)</span>
<span id="cb135-3"><a href="habitat-use.html#cb135-3" tabindex="-1"></a></span>
<span id="cb135-4"><a href="habitat-use.html#cb135-4" tabindex="-1"></a><span class="co"># Look at the output</span></span>
<span id="cb135-5"><a href="habitat-use.html#cb135-5" tabindex="-1"></a><span class="fu">summary</span>(lm_con)</span></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = Odocoileus.virginianus ~ z.line_of_sight_m, data = mod_dat)
## 
## Residuals:
##     Min      1Q  Median      3Q     Max 
## -3.9177 -2.7046 -0.5994  1.6422  7.0377 
## 
## Coefficients:
##                   Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)         2.6835     0.5157   5.203 8.06e-06 ***
## z.line_of_sight_m  -1.3898     0.5227  -2.659   0.0116 *  
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 3.179 on 36 degrees of freedom
## Multiple R-squared:  0.1642, Adjusted R-squared:  0.141 
## F-statistic: 7.071 on 1 and 36 DF,  p-value: 0.01162</code></pre>
<p>Here the effect represents the gradient of the relationship between <code>line_of_sight_m</code> and the habitat use of white-tailed deer. The effect is negative, and the p-value is below the arbitrary 0.05 threshold, which suggests it my be an important predictor of white-tailed deer habitat use.</p>
<p>It will make more sense if we plot it - again using <code>jtools</code></p>
<div class="sourceCode" id="cb137"><pre class="sourceCode r Rmain"><code class="sourceCode r"><span id="cb137-1"><a href="habitat-use.html#cb137-1" tabindex="-1"></a><span class="fu">effect_plot</span>(lm_con,                  <span class="co"># The model object</span></span>
<span id="cb137-2"><a href="habitat-use.html#cb137-2" tabindex="-1"></a>            <span class="at">pred =</span> z.line_of_sight_m,  <span class="co"># The variable you want to predict</span></span>
<span id="cb137-3"><a href="habitat-use.html#cb137-3" tabindex="-1"></a>            <span class="at">interval =</span> <span class="cn">TRUE</span>,         <span class="co"># Whether you want confidence intervals (default = 0.95)</span></span>
<span id="cb137-4"><a href="habitat-use.html#cb137-4" tabindex="-1"></a>            <span class="at">partial.residuals =</span> T,   <span class="co"># Show the residual variation -after accounting for fixed effects  </span></span>
<span id="cb137-5"><a href="habitat-use.html#cb137-5" tabindex="-1"></a>            <span class="at">y.label =</span> <span class="st">&quot;Habitat use&quot;</span>) <span class="co"># Change the y axis label</span></span></code></pre></div>
<p><img src="Intro-to-data-analysis_files/figure-html/ch7_16-1.png" width="672" /></p>
</div>
<div id="model-comparisons" class="section level3 hasAnchor" number="10.2.4">
<h3><span class="header-section-number">10.2.4</span> Model comparisons<a href="habitat-use.html#model-comparisons" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>There are times when we may want to compare which model is “the best”, or which model is the most parsimonious. One way to do this is through the use of Information Theory - we can compare which model explains the most amount of variation after applying a penalty for how complex it is (more complex models will always explain more variation, even if just by chance).</p>
<p>One useful package for this is the <code>MuMIn</code> package and the function <code>model.sel()</code> for model selection:</p>
<div class="sourceCode" id="cb138"><pre class="sourceCode r Rmain"><code class="sourceCode r"><span id="cb138-1"><a href="habitat-use.html#cb138-1" tabindex="-1"></a><span class="fu">library</span>(MuMIn)</span>
<span id="cb138-2"><a href="habitat-use.html#cb138-2" tabindex="-1"></a></span>
<span id="cb138-3"><a href="habitat-use.html#cb138-3" tabindex="-1"></a><span class="co"># Lets also create a &quot;null model&quot; something without any predictors in at all, to compare these models to:</span></span>
<span id="cb138-4"><a href="habitat-use.html#cb138-4" tabindex="-1"></a>lm_null <span class="ot">&lt;-</span> <span class="fu">lm</span>(Odocoileus.virginianus <span class="sc">~</span> <span class="dv">1</span>, <span class="at">data =</span> mod_dat) </span>
<span id="cb138-5"><a href="habitat-use.html#cb138-5" tabindex="-1"></a></span>
<span id="cb138-6"><a href="habitat-use.html#cb138-6" tabindex="-1"></a><span class="co"># Compare the results</span></span>
<span id="cb138-7"><a href="habitat-use.html#cb138-7" tabindex="-1"></a><span class="fu">model.sel</span>(lm_null, lm_cat, lm_con)</span></code></pre></div>
<pre><code>## Model selection table 
##         (Int) ftr_typ z.lin_of_sgh_m df   logLik  AICc delta weight
## lm_con  2.683                  -1.39  3  -96.844 200.4  0.00  0.821
## lm_cat  1.164       +                 4  -97.805 204.8  4.43  0.090
## lm_null 2.683                         2 -100.252 204.8  4.45  0.089
## Models ranked by AICc(x)</code></pre>
<p>Whilst both models improve on the null model, there is stronger support for <code>line_of_sight_m</code> than for our feature types in influencing white-tailed deer habitat use. Cool!</p>
</div>
<div id="problems-with-these-models" class="section level3 hasAnchor" number="10.2.5">
<h3><span class="header-section-number">10.2.5</span> Problems with these models<a href="habitat-use.html#problems-with-these-models" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>But can you see any problems with this type of model?</p>
<p>We probably should be concerned about the fact that:</p>
<ul>
<li>There are negative predictions for both sets of confidence intervals - but you can’t get a negative capture rate!</li>
<li>We do not account for seasonality - we saw species detection rates change with time of year in the <a href="exploration.html#exploration">data exploration section</a></li>
</ul>
<p>And more besides!</p>
</div>
<div id="mixed-effects-models" class="section level3 hasAnchor" number="10.2.6">
<h3><span class="header-section-number">10.2.6</span> Mixed-effects models<a href="habitat-use.html#mixed-effects-models" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Let’s build a more robust habitat-use model which addresses some of the issues highlighted here. To do this we will take advantage of a type of analysis called ‘mixed effects modelling’. Mixed effects models allow us to perform robust analysis of populations which have been repeatedly sampled through time. As such, we can break our data set down into months without violating the assumptions of the models.</p>
<p>If you are new to mixed effects models you must try this fantastic interactive aid to help you understand how they work: <a href="http://mfviz.com/hierarchical-models/">Michael Freeman’s ‘An Introduction to Hierarchical Modeling’</a></p>
<p>And for a deep-dive into the inner workings of mixed effects models and their assumptions, see the following paper:
<a href="https://peerj.com/articles/4794/">Harrison, Xavier A., et al. “A brief introduction to mixed effects modelling and multi-model inference in ecology.” PeerJ 6 (2018): e4794.</a></p>
<p>First we must install the packages we require: ‘lme4’ and `tidyr’:</p>
<div class="sourceCode" id="cb140"><pre class="sourceCode r Rmain"><code class="sourceCode r"><span id="cb140-1"><a href="habitat-use.html#cb140-1" tabindex="-1"></a> <span class="fu">library</span>(lme4); <span class="fu">library</span>(tidyr)</span>
<span id="cb140-2"><a href="habitat-use.html#cb140-2" tabindex="-1"></a></span>
<span id="cb140-3"><a href="habitat-use.html#cb140-3" tabindex="-1"></a><span class="co"># Import the monthly observations dataset</span></span>
<span id="cb140-4"><a href="habitat-use.html#cb140-4" tabindex="-1"></a>monthly_obs <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">&quot;data/processed_data/AlgarRestorationProject_30min_independent_monthly_observations.csv&quot;</span>, <span class="at">header=</span>T)</span>
<span id="cb140-5"><a href="habitat-use.html#cb140-5" tabindex="-1"></a></span>
<span id="cb140-6"><a href="habitat-use.html#cb140-6" tabindex="-1"></a><span class="co"># Add the locations (as before)</span></span>
<span id="cb140-7"><a href="habitat-use.html#cb140-7" tabindex="-1"></a>mod_dat <span class="ot">&lt;-</span> <span class="fu">left_join</span>(monthly_obs, z_locs)</span></code></pre></div>
<pre><code>## Joining with `by = join_by(placename)`</code></pre>
<div class="sourceCode" id="cb142"><pre class="sourceCode r Rmain"><code class="sourceCode r"><span id="cb142-1"><a href="habitat-use.html#cb142-1" tabindex="-1"></a><span class="co"># extract month from the data frames</span></span>
<span id="cb142-2"><a href="habitat-use.html#cb142-2" tabindex="-1"></a>mod_dat<span class="sc">$</span>date <span class="ot">&lt;-</span> <span class="fu">ym</span>(mod_dat<span class="sc">$</span>date)</span>
<span id="cb142-3"><a href="habitat-use.html#cb142-3" tabindex="-1"></a>mod_dat<span class="sc">$</span>month<span class="ot">&lt;-</span> <span class="fu">month</span>(mod_dat<span class="sc">$</span>date, <span class="at">label=</span>T)</span>
<span id="cb142-4"><a href="habitat-use.html#cb142-4" tabindex="-1"></a></span>
<span id="cb142-5"><a href="habitat-use.html#cb142-5" tabindex="-1"></a><span class="co"># Convert month into a simple summer and winter comparison</span></span>
<span id="cb142-6"><a href="habitat-use.html#cb142-6" tabindex="-1"></a>mod_dat<span class="sc">$</span>season <span class="ot">&lt;-</span> <span class="st">&quot;summer&quot;</span></span>
<span id="cb142-7"><a href="habitat-use.html#cb142-7" tabindex="-1"></a>mod_dat<span class="sc">$</span>season[<span class="fu">month</span>(mod_dat<span class="sc">$</span>date) <span class="sc">%in%</span> <span class="fu">c</span>(<span class="dv">10</span>,<span class="dv">11</span>,<span class="dv">12</span>,<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>)] <span class="ot">&lt;-</span> <span class="st">&quot;winter&quot;</span></span>
<span id="cb142-8"><a href="habitat-use.html#cb142-8" tabindex="-1"></a></span>
<span id="cb142-9"><a href="habitat-use.html#cb142-9" tabindex="-1"></a><span class="co"># make it a factor </span></span>
<span id="cb142-10"><a href="habitat-use.html#cb142-10" tabindex="-1"></a>mod_dat <span class="ot">&lt;-</span> mod_dat <span class="sc">%&gt;%</span> </span>
<span id="cb142-11"><a href="habitat-use.html#cb142-11" tabindex="-1"></a>            <span class="fu">mutate_if</span>(is.character,as.factor)</span>
<span id="cb142-12"><a href="habitat-use.html#cb142-12" tabindex="-1"></a></span>
<span id="cb142-13"><a href="habitat-use.html#cb142-13" tabindex="-1"></a><span class="co"># Run the model</span></span>
<span id="cb142-14"><a href="habitat-use.html#cb142-14" tabindex="-1"></a>glmm_cat <span class="ot">&lt;-</span> <span class="fu">glmer.nb</span>(Odocoileus.virginianus <span class="sc">~</span> </span>
<span id="cb142-15"><a href="habitat-use.html#cb142-15" tabindex="-1"></a>                    feature_type <span class="sc">+</span> season <span class="sc">+</span> <span class="fu">offset</span>(<span class="fu">log</span>(days)) <span class="sc">+</span> (<span class="dv">1</span><span class="sc">|</span>placename) , <span class="at">data=</span>mod_dat)</span>
<span id="cb142-16"><a href="habitat-use.html#cb142-16" tabindex="-1"></a></span>
<span id="cb142-17"><a href="habitat-use.html#cb142-17" tabindex="-1"></a><span class="co"># Check the model fit</span></span>
<span id="cb142-18"><a href="habitat-use.html#cb142-18" tabindex="-1"></a><span class="fu">summary</span>(glmm_cat)</span></code></pre></div>
<pre><code>## Generalized linear mixed model fit by maximum likelihood (Laplace
##   Approximation) [glmerMod]
##  Family: Negative Binomial(0.8362)  ( log )
## Formula: Odocoileus.virginianus ~ feature_type + season + offset(log(days)) +  
##     (1 | placename)
##    Data: mod_dat
## 
##      AIC      BIC   logLik deviance df.resid 
##   1337.6   1364.9   -662.8   1325.6      691 
## 
## Scaled residuals: 
##     Min      1Q  Median      3Q     Max 
## -0.8336 -0.4267 -0.1919 -0.1210  6.5197 
## 
## Random effects:
##  Groups    Name        Variance Std.Dev.
##  placename (Intercept) 3.758    1.939   
## Number of obs: 697, groups:  placename, 38
## 
## Fixed effects:
##                      Estimate Std. Error z value Pr(&gt;|z|)    
## (Intercept)           -5.7986     0.6205  -9.345   &lt;2e-16 ***
## feature_typeNatRegen   1.9662     0.8612   2.283   0.0224 *  
## feature_typeOffline    1.0860     0.8379   1.296   0.1949    
## seasonwinter          -0.4427     0.1566  -2.827   0.0047 ** 
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Correlation of Fixed Effects:
##             (Intr) ftr_NR ftr_tO
## ftr_typNtRg -0.695              
## ftr_typOffl -0.694  0.497       
## seasonwintr -0.073 -0.011 -0.008</code></pre>
<p>We can plot the predictions from these models using the <code>jtools</code> package.</p>
<p>First lets look at the effects of <code>feature_type</code>:</p>
<div class="sourceCode" id="cb144"><pre class="sourceCode r Rmain"><code class="sourceCode r"><span id="cb144-1"><a href="habitat-use.html#cb144-1" tabindex="-1"></a><span class="fu">effect_plot</span>(glmm_cat, <span class="at">pred =</span> feature_type, <span class="at">interval =</span> <span class="cn">TRUE</span>, <span class="at">y.label =</span> <span class="st">&quot;Habitat use&quot;</span>,</span>
<span id="cb144-2"><a href="habitat-use.html#cb144-2" tabindex="-1"></a>            , <span class="at">data=</span>mod_dat)</span></code></pre></div>
<pre><code>## Outcome is based on a total of 1 exposures</code></pre>
<pre><code>## Confidence intervals for merMod models is an experimental feature. The
## intervals reflect only the variance of the fixed effects, not the random
## effects.</code></pre>
<p><img src="Intro-to-data-analysis_files/figure-html/ch7_28-1.png" width="672" /></p>
<p>As with our simple linear model, the mixed effects model also suggests a difference between the different <code>feature_type</code> strata for white-tailed deer.</p>
<p>Lets also look at the effect of our new <code>season</code> variable:</p>
<div class="sourceCode" id="cb147"><pre class="sourceCode r Rmain"><code class="sourceCode r"><span id="cb147-1"><a href="habitat-use.html#cb147-1" tabindex="-1"></a><span class="fu">effect_plot</span>(glmm_cat, <span class="at">pred =</span> season, <span class="at">interval =</span> <span class="cn">TRUE</span>, <span class="at">y.label =</span> <span class="st">&quot;Habitat use&quot;</span>,</span>
<span id="cb147-2"><a href="habitat-use.html#cb147-2" tabindex="-1"></a>            , <span class="at">data=</span>mod_dat)</span></code></pre></div>
<p><img src="Intro-to-data-analysis_files/figure-html/ch7_29-1.png" width="672" /></p>
<p>Which suggests habitat use is slightly lower habitat use in winter then in summer.</p>
</div>
<div id="advanced-mixed-model-predictions" class="section level3 hasAnchor" number="10.2.7">
<h3><span class="header-section-number">10.2.7</span> Advanced mixed-model predictions<a href="habitat-use.html#advanced-mixed-model-predictions" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Tools such as <code>jtools</code> are great for generating simple predictions from mixed models, however the more complex the models get, the more you may want to specify your own prediction dataframes.</p>
<p>If you want more applied examples of generating predictions from mixed effects models, check out <a href="https://bbolker.github.io/mixedmodels-misc/ecostats_chap.html">Ben Bolkers workbook</a>. There is also some great discussion about model selection and r-squared values.</p>
</div>
<div id="examples-in-the-literature-1" class="section level3 hasAnchor" number="10.2.8">
<h3><span class="header-section-number">10.2.8</span> Examples in the literature<a href="habitat-use.html#examples-in-the-literature-1" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p><a href="https://www.sciencedirect.com/science/article/abs/pii/S0006320719307013">Tattersall, E. R., Burgar, J. M., Fisher, J. T., &amp; Burton, A. C. (2020). Mammal seismic line use varies with restoration: Applying habitat restoration to species at risk conservation in a working landscape. Biological Conservation, 241, 108295.</a></p>
</div>
</div>
<div id="multispecies-models" class="section level2 hasAnchor" number="10.3">
<h2><span class="header-section-number">10.3</span> Multispecies models<a href="habitat-use.html#multispecies-models" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>In the above examples, we analyse each individual species separately. This is great if you only care about one species, however we often want a more holistic understanding of wildlife communities! Recent advances in computer power and analytic approaches mean it is becoming increasingly popular to model multiple species within the same framework! This opens up a variety of things not previously possible.</p>
<p><strong>A note of caution</strong> In experimenting with single species models you may have realized it can sometimes be hard to build a sensible and robust model. Now do this for &gt;10 species in the <strong>same model</strong>, and the potential to get silly results increases. Tread carefully!</p>
<p>As with single species linear models, there are many choices available for modeling multiple species in the same framework. Two notable options are:</p>
<ul>
<li><a href="https://cran.r-project.org/web/packages/gjam/vignettes/gjamVignette.html">GJAM</a></li>
<li><a href="https://www2.helsinki.fi/en/researchgroups/statistical-ecology/hmsc">HMSc</a></li>
</ul>
<p>In this example we will use the <code>Hmsc</code> package.</p>
<div class="sourceCode" id="cb148"><pre class="sourceCode r Rmain"><code class="sourceCode r"><span id="cb148-1"><a href="habitat-use.html#cb148-1" tabindex="-1"></a><span class="fu">library</span>(Hmsc)</span>
<span id="cb148-2"><a href="habitat-use.html#cb148-2" tabindex="-1"></a></span>
<span id="cb148-3"><a href="habitat-use.html#cb148-3" tabindex="-1"></a><span class="co"># Prepare our data</span></span>
<span id="cb148-4"><a href="habitat-use.html#cb148-4" tabindex="-1"></a><span class="co"># Pull the count data into its own matrix</span></span>
<span id="cb148-5"><a href="habitat-use.html#cb148-5" tabindex="-1"></a>Y <span class="ot">&lt;-</span> <span class="fu">as.matrix</span>(monthly_obs[,sp_summary<span class="sc">$</span>sp])</span>
<span id="cb148-6"><a href="habitat-use.html#cb148-6" tabindex="-1"></a></span>
<span id="cb148-7"><a href="habitat-use.html#cb148-7" tabindex="-1"></a><span class="co"># Give the row names a useful label, in this case the site_date values </span></span>
<span id="cb148-8"><a href="habitat-use.html#cb148-8" tabindex="-1"></a><span class="co"># (just in case you want to check things)</span></span>
<span id="cb148-9"><a href="habitat-use.html#cb148-9" tabindex="-1"></a><span class="fu">row.names</span>(Y) <span class="ot">&lt;-</span> <span class="fu">paste</span>(monthly_obs<span class="sc">$</span>placename, monthly_obs<span class="sc">$</span>date, <span class="at">sep=</span><span class="st">&quot;_&quot;</span>)</span>
<span id="cb148-10"><a href="habitat-use.html#cb148-10" tabindex="-1"></a></span>
<span id="cb148-11"><a href="habitat-use.html#cb148-11" tabindex="-1"></a><span class="co"># Join with the location data</span></span>
<span id="cb148-12"><a href="habitat-use.html#cb148-12" tabindex="-1"></a>Xdat <span class="ot">&lt;-</span> <span class="fu">left_join</span>(monthly_obs[<span class="fu">c</span>(<span class="st">&quot;placename&quot;</span>, <span class="st">&quot;date&quot;</span>, <span class="st">&quot;days&quot;</span>)], z_locs)</span>
<span id="cb148-13"><a href="habitat-use.html#cb148-13" tabindex="-1"></a><span class="co"># All XData must be numeric or factors, so lets check what we have</span></span>
<span id="cb148-14"><a href="habitat-use.html#cb148-14" tabindex="-1"></a></span>
<span id="cb148-15"><a href="habitat-use.html#cb148-15" tabindex="-1"></a></span>
<span id="cb148-16"><a href="habitat-use.html#cb148-16" tabindex="-1"></a><span class="co"># Set up the sampling conditions</span></span>
<span id="cb148-17"><a href="habitat-use.html#cb148-17" tabindex="-1"></a>nChains   <span class="ot">=</span> <span class="dv">2</span>       <span class="co"># How many total repeats to run</span></span>
<span id="cb148-18"><a href="habitat-use.html#cb148-18" tabindex="-1"></a>thin      <span class="ot">=</span> <span class="dv">5</span>       <span class="co"># How often to thin the samples</span></span>
<span id="cb148-19"><a href="habitat-use.html#cb148-19" tabindex="-1"></a>samples   <span class="ot">=</span> <span class="dv">100</span>     <span class="co"># How many samples to take  </span></span>
<span id="cb148-20"><a href="habitat-use.html#cb148-20" tabindex="-1"></a>transient <span class="ot">=</span> <span class="dv">200</span> <span class="co"># How long should the &quot;warm up&quot; be</span></span>
<span id="cb148-21"><a href="habitat-use.html#cb148-21" tabindex="-1"></a>verbose   <span class="ot">=</span> T       <span class="co"># Give reports on model progress</span></span>
<span id="cb148-22"><a href="habitat-use.html#cb148-22" tabindex="-1"></a></span>
<span id="cb148-23"><a href="habitat-use.html#cb148-23" tabindex="-1"></a><span class="co"># Specify the random effects</span></span>
<span id="cb148-24"><a href="habitat-use.html#cb148-24" tabindex="-1"></a><span class="co"># Add a station-level random effect (for the co-variances)</span></span>
<span id="cb148-25"><a href="habitat-use.html#cb148-25" tabindex="-1"></a>studyDesign <span class="ot">=</span> <span class="fu">data.frame</span>(<span class="at">station =</span> <span class="fu">as.factor</span>(Xdat<span class="sc">$</span>placename))</span>
<span id="cb148-26"><a href="habitat-use.html#cb148-26" tabindex="-1"></a>rL <span class="ot">=</span> <span class="fu">HmscRandomLevel</span>(<span class="at">units =</span> studyDesign<span class="sc">$</span>station)</span>
<span id="cb148-27"><a href="habitat-use.html#cb148-27" tabindex="-1"></a></span>
<span id="cb148-28"><a href="habitat-use.html#cb148-28" tabindex="-1"></a><span class="co"># Model specification</span></span>
<span id="cb148-29"><a href="habitat-use.html#cb148-29" tabindex="-1"></a>mod <span class="ot">&lt;-</span> <span class="fu">Hmsc</span>(<span class="at">Y =</span> Y, </span>
<span id="cb148-30"><a href="habitat-use.html#cb148-30" tabindex="-1"></a>            <span class="at">XData =</span> Xdat[,<span class="fu">c</span>(<span class="st">&quot;z.line_of_sight_m&quot;</span>, <span class="st">&quot;z.water_depth_m&quot;</span>, <span class="st">&quot;days&quot;</span>)], </span>
<span id="cb148-31"><a href="habitat-use.html#cb148-31" tabindex="-1"></a>            <span class="at">XFormula =</span> <span class="sc">~</span>z.line_of_sight_m <span class="sc">+</span> z.water_depth_m <span class="sc">+</span> <span class="fu">log</span>(days),</span>
<span id="cb148-32"><a href="habitat-use.html#cb148-32" tabindex="-1"></a>            <span class="at">studyDesign =</span> studyDesign, </span>
<span id="cb148-33"><a href="habitat-use.html#cb148-33" tabindex="-1"></a>            <span class="at">ranLevels =</span> <span class="fu">list</span>(<span class="at">station =</span> rL), </span>
<span id="cb148-34"><a href="habitat-use.html#cb148-34" tabindex="-1"></a>            <span class="at">distr=</span><span class="st">&quot;poisson&quot;</span>)</span>
<span id="cb148-35"><a href="habitat-use.html#cb148-35" tabindex="-1"></a></span>
<span id="cb148-36"><a href="habitat-use.html#cb148-36" tabindex="-1"></a></span>
<span id="cb148-37"><a href="habitat-use.html#cb148-37" tabindex="-1"></a><span class="co"># Fit the model</span></span>
<span id="cb148-38"><a href="habitat-use.html#cb148-38" tabindex="-1"></a>out <span class="ot">&lt;-</span>  <span class="fu">sampleMcmc</span>(mod, <span class="at">thin =</span> thin, <span class="at">samples =</span> samples, <span class="at">transient =</span> transient,</span>
<span id="cb148-39"><a href="habitat-use.html#cb148-39" tabindex="-1"></a>               <span class="at">nChains =</span> nChains, <span class="at">verbose =</span> verbose)</span></code></pre></div>
<p>We can plot a basic summary of the modeled effects using the following code.</p>
<div class="sourceCode" id="cb149"><pre class="sourceCode r Rmain"><code class="sourceCode r"><span id="cb149-1"><a href="habitat-use.html#cb149-1" tabindex="-1"></a>postBeta <span class="ot">=</span> <span class="fu">getPostEstimate</span>(out, <span class="at">parName =</span> <span class="st">&quot;Beta&quot;</span>)</span>
<span id="cb149-2"><a href="habitat-use.html#cb149-2" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mar=</span><span class="fu">c</span>(<span class="dv">8</span>,<span class="dv">12</span>,<span class="dv">1</span>,<span class="dv">1</span>))</span>
<span id="cb149-3"><a href="habitat-use.html#cb149-3" tabindex="-1"></a><span class="fu">plotBeta</span>(out, <span class="at">post =</span> postBeta, <span class="at">param =</span> <span class="st">&quot;Support&quot;</span>, <span class="at">supportLevel =</span> <span class="fl">0.95</span>)</span></code></pre></div>
<p><img src="Intro-to-data-analysis_files/figure-html/ch7_40-1.png" width="672" /></p>
<p>We the colors denote the size and magnitude of the effect of proportion of lowland habitat. <em>NOTE</em> treat these results with caution as the number of model runs is very low (to increase speed) and the model assumptions have not been interrogated.</p>
<div class="sourceCode" id="cb150"><pre class="sourceCode r Rmain"><code class="sourceCode r"><span id="cb150-1"><a href="habitat-use.html#cb150-1" tabindex="-1"></a>OmegaCor <span class="ot">=</span> <span class="fu">computeAssociations</span>(out)</span>
<span id="cb150-2"><a href="habitat-use.html#cb150-2" tabindex="-1"></a></span>
<span id="cb150-3"><a href="habitat-use.html#cb150-3" tabindex="-1"></a>supportLevel <span class="ot">=</span> <span class="fl">0.0</span></span>
<span id="cb150-4"><a href="habitat-use.html#cb150-4" tabindex="-1"></a></span>
<span id="cb150-5"><a href="habitat-use.html#cb150-5" tabindex="-1"></a>toPlot <span class="ot">=</span> ((OmegaCor[[<span class="dv">1</span>]]<span class="sc">$</span>support<span class="sc">&gt;</span>supportLevel)</span>
<span id="cb150-6"><a href="habitat-use.html#cb150-6" tabindex="-1"></a><span class="sc">+</span> (OmegaCor[[<span class="dv">1</span>]]<span class="sc">$</span>support<span class="sc">&lt;</span>(<span class="dv">1</span><span class="sc">-</span>supportLevel))<span class="sc">&gt;</span><span class="dv">0</span>)<span class="sc">*</span>OmegaCor[[<span class="dv">1</span>]]<span class="sc">$</span>mean</span>
<span id="cb150-7"><a href="habitat-use.html#cb150-7" tabindex="-1"></a></span>
<span id="cb150-8"><a href="habitat-use.html#cb150-8" tabindex="-1"></a></span>
<span id="cb150-9"><a href="habitat-use.html#cb150-9" tabindex="-1"></a><span class="fu">corrplot</span>(toPlot, </span>
<span id="cb150-10"><a href="habitat-use.html#cb150-10" tabindex="-1"></a>         <span class="at">method =</span> <span class="st">&quot;color&quot;</span>,</span>
<span id="cb150-11"><a href="habitat-use.html#cb150-11" tabindex="-1"></a>         <span class="at">type=</span><span class="st">&quot;upper&quot;</span>,</span>
<span id="cb150-12"><a href="habitat-use.html#cb150-12" tabindex="-1"></a>         <span class="at">order =</span> <span class="st">&quot;FPC&quot;</span>,</span>
<span id="cb150-13"><a href="habitat-use.html#cb150-13" tabindex="-1"></a>        <span class="at">col =</span> <span class="fu">colorRampPalette</span>(<span class="fu">c</span>(<span class="st">&quot;blue&quot;</span>,<span class="st">&quot;white&quot;</span>,<span class="st">&quot;red&quot;</span>))(<span class="dv">200</span>),</span>
<span id="cb150-14"><a href="habitat-use.html#cb150-14" tabindex="-1"></a>        <span class="at">title =</span> <span class="fu">paste</span>(<span class="st">&quot;random effect level:&quot;</span>, </span>
<span id="cb150-15"><a href="habitat-use.html#cb150-15" tabindex="-1"></a>                      mod<span class="sc">$</span>rLNames[<span class="dv">1</span>]), <span class="at">mar=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">0</span>))</span></code></pre></div>
<p><img src="Intro-to-data-analysis_files/figure-html/ch7_41-1.png" width="672" /></p>
<div id="potential-dangers" class="section level3 hasAnchor" number="10.3.1">
<h3><span class="header-section-number">10.3.1</span> Potential dangers<a href="habitat-use.html#potential-dangers" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>The analysis has worked and we have some really stylish output! But - take screenshots of the output and run it again. Compare your screen shots.</p>
<p>Bayesian solvers don’t work the same way as frequentist approaches. With frequentist approaches you get the same result every time, with bayesian approaches a solver explores the parameter space to “find” the right solution. If you do not give time for the solver to coverage on the right solution, you will get a result that is not in the slightest bit reliable!</p>
<p>For a nice overview on assessing Bayesian model convergence see Michael Clark’s <a href="https://m-clark.github.io/bayesian-basics/diagnostics.html">bayseian model diagnostics page</a>.</p>
<p>Let’s have a look at our traceplots - these are plots which show the Bayesian solvers efforts to converge on the answer for each parameter with each iteration of the model (red and black done the different runs). If they have converged on a solution they should be steady and stable, the coloured lines on the left should overlap and the density plot on the right should be uni-modal.</p>
<p>First for the fixed effects in the model:</p>
<div class="sourceCode" id="cb151"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb151-1"><a href="habitat-use.html#cb151-1" tabindex="-1"></a>mpost <span class="ot">=</span> <span class="fu">convertToCodaObject</span>(out)</span>
<span id="cb151-2"><a href="habitat-use.html#cb151-2" tabindex="-1"></a><span class="fu">plot</span>(mpost<span class="sc">$</span>Beta)</span></code></pre></div>
<p>What do you think?</p>
<p>These sampling chains will have to be much longer for these models to converge!</p>
</div>
<div id="further-reading" class="section level3 hasAnchor" number="10.3.2">
<h3><span class="header-section-number">10.3.2</span> Further reading<a href="habitat-use.html#further-reading" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>The best place for examples of HMSC analyses right now are package vignettes:</p>
<p><a href="https://cran.r-project.org/web/packages/Hmsc/vignettes/vignette_1_univariate.pdf">Getting started with HMSC-R: univariate models</a></p>
<p><a href="https://cran.r-project.org/web/packages/Hmsc/vignettes/vignette_2_multivariate_low.pdf">Getting started with HMSC-R: low-dimensional multivariate models</a></p>
<p><a href="https://cran.r-project.org/web/packages/Hmsc/vignettes/vignette_3_multivariate_high.pdf">Getting started with HMSC-R: high-dimensional multivariate models</a></p>
<p><a href="https://cran.r-project.org/web/packages/Hmsc/vignettes/vignette_4_spatial.pdf">Getting started with HMSC-R: spatial models</a></p>
</div>
<div id="examples-in-the-literature-2" class="section level3 hasAnchor" number="10.3.3">
<h3><span class="header-section-number">10.3.3</span> Examples in the literature<a href="habitat-use.html#examples-in-the-literature-2" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p><a href="https://www.sciencedirect.com/science/article/pii/S0378112720300803">Carvalho Jr, Elildo AR, et al. “Effects of illegal logging on Amazonian medium and large-sized terrestrial vertebrates.” Forest Ecology and Management 466 (2020): 118105.</a></p>
<p><a href="https://besjournals.onlinelibrary.wiley.com/doi/abs/10.1111/1365-2664.14020">Beirne, Christopher, et al. “Multispecies modelling reveals potential for habitat restoration to re‐establish boreal vertebrate community dynamics.” Journal of Applied Ecology 58.12 (2021): 2821-2832.</a></p>

</div>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="composition.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="occupancy.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/rstudio/bookdown-demo/edit/master/07-habitat_use.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["Intro-to-data-analysis.pdf", "Intro-to-data-analysis.epub"],
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "subsection"
}
});
});
</script>

</body>

</html>
